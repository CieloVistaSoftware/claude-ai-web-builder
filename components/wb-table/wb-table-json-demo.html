<!DOCTYPE html>
<html lang="en" data-theme="dark">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>WB Table JSON Demo</title>
        <link rel="stylesheet" href="../wb-demo/wb-demo.css">
        <script type="module" src="../wb-demo/wb-demo.js"></script>
        <link rel="stylesheet" href="../../styles/main.css">
    </head>

    <body>
        <wb-table 
            data-json='[{"id":1,"name":"John Doe","email":"john@example.com","role":"Admin"},{"id":2,"name":"Jane Smith","email":"jane@example.com","role":"User"},{"id":3,"name":"Bob Wilson","email":"bob@example.com","role":"Editor"}]'>
        </wb-table>

        <!-- <wb-demo markdown="wb-table.md" 
            title="WB Table: Direct JSON Attribute">           
            <div class="table-container" slot="examples">
    
            </div>
        </wb-demo> -->


        <!-- Programmatic JSON -->

    <script type="module" src="wb-table.js"></script>
    <script>
            let errorCounter = 1;
            let taskCounter = 1;

            // Global data for data binding demo
            window.tasksData = [
                { id: 1, title: 'Setup project', priority: 'high', status: 'complete', assignee: 'John' },
                { id: 2, title: 'Write tests', priority: 'medium', status: 'pending', assignee: 'Jane' }
            ];

            function loadErrorLog() {
                const table = document.getElementById('error-table');
                table.setData([
                    { level: 'error', timestamp: '10:30:45', source: 'app.js', message: 'Failed to connect to database' },
                    { level: 'warn', timestamp: '10:31:12', source: 'utils.js', message: 'Deprecated function used' },
                    { level: 'info', timestamp: '10:32:00', source: 'main.js', message: 'Application started successfully' },
                    { level: 'error', timestamp: '10:33:15', source: 'auth.js', message: 'Invalid login credentials' }
                ]);
                updateStats();
            }

            function addError() {
                const table = document.getElementById('error-table');
                const now = new Date();
                table.addRow({
                    level: 'error',
                    timestamp: now.toLocaleTimeString(),
                    source: 'demo.js',
                    message: `Error ${++errorCounter}: Something went wrong`
                });
                updateStats();
            }

            function addWarning() {
                const table = document.getElementById('error-table');
                const now = new Date();
                table.addRow({
                    level: 'warn',
                    timestamp: now.toLocaleTimeString(),
                    source: 'demo.js',
                    message: `Warning ${++errorCounter}: This is a warning`
                });
                updateStats();
            }

            function clearLog() {
                const table = document.getElementById('error-table');
                table.clear();
                errorCounter = 1;
                updateStats();
            }

            function addTask() {
                const tasks = ['Review code', 'Fix bug', 'Update docs', 'Deploy app', 'Test feature'];
                const priorities = ['high', 'medium', 'low'];
                const statuses = ['pending', 'progress', 'complete'];
                const assignees = ['Alice', 'Bob', 'Carol', 'Dave'];

                window.tasksData.unshift({
                    id: ++taskCounter + 2,
                    title: tasks[Math.floor(Math.random() * tasks.length)],
                    priority: priorities[Math.floor(Math.random() * priorities.length)],
                    status: statuses[Math.floor(Math.random() * statuses.length)],
                    assignee: assignees[Math.floor(Math.random() * assignees.length)]
                });
                updateStats();
            }

            function updateTask() {
                if (window.tasksData.length > 0) {
                    const task = window.tasksData[0];
                    const statuses = ['pending', 'progress', 'complete'];
                    task.status = statuses[Math.floor(Math.random() * statuses.length)];
                    updateStats();
                }
            }

            function clearTasks() {
                window.tasksData = [];
                taskCounter = 1;
                updateStats();
            }



            // Assign references after DOM is ready
            let errorTable, tasksTable;
            window.addEventListener('DOMContentLoaded', () => {
                errorTable = document.getElementById('error-table');
                tasksTable = document.getElementById('tasks-table');
                updateStats();
            });

            function updateStats() {
                if (!errorTable) return;
                document.getElementById('error-stats').textContent = `${errorTable.getRowCount()} rows`;
                document.getElementById('tasks-stats').textContent = `${window.tasksData.length} rows`;
            }

            // Listen for table events
            document.addEventListener('wb-table:dataChanged', (e) => {
                console.log('Table data changed:', e.detail);
            });

            document.addEventListener('wb-table:rowAdded', (e) => {
                console.log('Row added:', e.detail);
            });

            // Listen for table events
            document.addEventListener('wb-table:dataChanged', (e) => {
                console.log('Table data changed:', e.detail);
            });

            document.addEventListener('wb-table:rowAdded', (e) => {
                console.log('Row added:', e.detail);
            });
        </script>
    </body>

</html>


