<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Color Bars Component Demo</title>
    
    <!-- LayoutSystem CSS Imports -->
    <link rel="stylesheet" href="../../styles/main.css">
    <link rel="stylesheet" href="../../wb-core/layouts/layouts.css">
    <link rel="stylesheet" href="color-bars-demo.css">
</head>
<body>
    <button class="theme-toggle" onclick="toggleTheme()">ðŸŒ™ Toggle Theme</button>
    
    <div class="container">
        <h1>ðŸŽ¨ Color Bars Component Demo</h1>
        
        <div class="demo-grid">
            <!-- Main Color Picker Demo -->
            <div class="demo-card full-width">
                <h3>Interactive HSL Color Picker</h3>
                <p>This wb-color-bars component contains three individual color bars for hue, saturation, and lightness control:</p>
                <wb-color-bars id="main-color" label="Color Picker" hue="240" saturation="70" lightness="50" theme="dark"></wb-color-bars>
                <div class="color-output">
                    <h4>Selected Color:</h4>
                    <div class="color-preview-box" id="main-preview"></div>
                    <div class="color-values" id="main-values">
                        HSL: hsl(240, 70%, 50%)<br>
                        HEX: #6366f1<br>
                        RGB: rgb(99, 102, 241)
                    </div>
                </div>
            </div>
            
            <!-- Theme Selector Demo -->
            <div class="demo-card">
                <h3>Theme Preset Colors</h3>
                <p>Select from predefined color themes:</p>
                <select id="theme-selector" class="theme-select">
                    <option value="custom" selected>Custom Theme</option>
                    <option value="material">Material Design</option>
                    <option value="ocean">Ocean Blue</option>
                    <option value="forest">Forest Green</option>
                    <option value="sunset">Sunset Orange</option>
                    <option value="purple">Purple Theme</option>
                </select>
                <wb-color-bars id="theme-color" label="Theme Color" hue="240" saturation="70" lightness="50" theme="dark"></wb-color-bars>
                <div class="color-output">
                    <h4>Theme Preview:</h4>
                    <div class="color-preview-box" id="theme-preview"></div>
                    <div class="color-values" id="theme-values">
                        HSL: hsl(240, 70%, 50%)<br>
                        HEX: #6366f1<br>
                        RGB: rgb(99, 102, 241)
                    </div>
                </div>
            </div>
            
            <!-- Complementary Color Demo -->
            <div class="demo-card">
                <h3>Complementary Accent Color</h3>
                <p>Automatically calculated complementary color:</p>
                <div class="color-output">
                    <h4>Accent Color:</h4>
                    <div class="color-preview-box" id="accent-preview"></div>
                    <div class="color-values" id="accent-values">
                        HSL: hsl(60, 70%, 50%)<br>
                        HEX: #e6e633<br>
                        RGB: rgb(230, 230, 51)
                    </div>
                </div>
            </div>
        </div>
        
        <!-- API Documentation -->
        <div class="api-section">
            <h2>ðŸ”§ API Reference</h2>
            
            <h3>Attributes</h3>
            <ul class="feature-list">
                <li><strong>hue</strong>: Initial hue value (0-360 degrees)</li>
                <li><strong>saturation</strong>: Initial saturation percentage (0-100%)</li>
                <li><strong>lightness</strong>: Initial lightness percentage (0-100%)</li>
                <li><strong>label</strong>: Label text for the color picker</li>
                <li><strong>theme</strong>: Theme variant ('light' or 'dark')</li>
                <li><strong>disabled</strong>: Disables the color picker</li>
            </ul>
            
            <h3>Events</h3>
            <ul class="feature-list">
                <li><strong>colorchange</strong>: Fired when color changes (real-time)</li>
                <li><strong>colorselect</strong>: Fired when user finishes selecting</li>
                <li><strong>colorcopied</strong>: Fired when hex value is copied</li>
            </ul>
            
            <h3>Usage Example</h3>
            <pre><code>&lt;wb-color-bars id="my-color" hue="240" saturation="70" lightness="50"&gt;&lt;/wb-color-bars&gt;

&lt;script&gt;
const colorPicker = document.getElementById('my-color');

colorPicker.addEventListener('colorchange', (e) => {
    console.log('Color changed:', e.detail);
    // e.detail contains: { hue, saturation, lightness, hsl, hex, rgb }
});

colorPicker.addEventListener('colorselect', (e) => {
    console.log('Color selected:', e.detail.hex);
});

// Programmatic control
colorPicker.setColor(180, 60, 40);
console.log('Current color:', colorPicker.color);
&lt;/script&gt;</code></pre>
            
            <h3>Features</h3>
            <ul class="feature-list">
                <li>Interactive HSL color selection with three bars</li>
                <li>Real-time color preview and value display</li>
                <li>Mouse, touch, and keyboard support</li>
                <li>Copy to clipboard functionality</li>
                <li>Accessibility features and ARIA support</li>
                <li>Theme support (light/dark modes)</li>
                <li>Material Design inspired interface</li>
                <li>Responsive design for all screen sizes</li>
            </ul>
        </div>
    </div>
    
    <script src="../../utils/wb/wb-component-utils.js"></script>
    <script src="../color-bar/wb-color-bar.js"></script>
    <script src="wb-color-bars.js"></script>
    <script src="color-bars-demo.js"></script>        // Initialize all color pickers
        const colorPickers = [
            { id: 'basic-color', previewId: 'basic-preview', valuesId: 'basic-values' },
            { id: 'custom-color', previewId: 'custom-preview', valuesId: 'custom-values' },
            { id: 'primary-color', previewId: 'primary-preview', valuesId: 'primary-values' }
        ];
        
        // Function to calculate complementary accent color
        function calculateAccentColor(primaryHue, primarySaturation, primaryLightness) {
            // Calculate complementary hue (opposite on color wheel)
            const accentHue = (primaryHue + 180) % 360;
            // Keep similar saturation and lightness for harmony
            const accentSaturation = Math.max(60, primarySaturation - 10);
            const accentLightness = primaryLightness > 50 ? primaryLightness - 15 : primaryLightness + 15;
            
            return { hue: accentHue, saturation: accentSaturation, lightness: accentLightness };
        }
        
        // Function to convert HSL to hex
        function hslToHex(h, s, l) {
            h /= 360;
            s /= 100;
            l /= 100;
            
            const a = s * Math.min(l, 1 - l);
            const f = n => {
                const k = (n + h / (1/12)) % 12;
                const color = l - a * Math.max(Math.min(k - 3, 9 - k, 1), -1);
                return Math.round(255 * color);
            };
            
            const r = f(0);
            const g = f(8);
            const b = f(4);
            
            return \`#\${[r, g, b].map(x => x.toString(16).padStart(2, '0')).join('')}\`;
        }
        
        // Function to update accent color display
        function updateAccentDisplay(primaryColor) {
            const accent = calculateAccentColor(primaryColor.hue, primaryColor.saturation, primaryColor.lightness);
            const accentHex = hslToHex(accent.hue, accent.saturation, accent.lightness);
            const accentHsl = \`hsl(\${accent.hue}, \${accent.saturation}%, \${accent.lightness}%)\`;
            
            const accentPreview = document.getElementById('accent-preview');
            const accentValues = document.getElementById('accent-values');
            
            if (accentPreview) {
                accentPreview.style.backgroundColor = accentHex;
                accentPreview.style.color = accentHex;
            }
            
            if (accentValues) {
                accentValues.innerHTML = \`
                    HSL: \${accentHsl}<br>
                    HEX: \${accentHex}<br>
                    RGB: rgb(\${Math.round(accent.hue)}, \${accent.saturation}, \${accent.lightness})
                \`;
            }
        }
        
        // Wait for components to be fully loaded
        setTimeout(() => {
            colorPickers.forEach(({ id, previewId, valuesId }) => {
                const picker = document.getElementById(id);
                const preview = document.getElementById(previewId);
                const values = document.getElementById(valuesId);
                
                if (!picker || !preview || !values) return;
                
                function updateDisplay(colorData) {
                    preview.style.backgroundColor = colorData.hex;
                    preview.style.color = colorData.hex;
                    values.innerHTML = \`
                        HSL: \${colorData.hsl}<br>
                        HEX: \${colorData.hex}<br>
                        RGB: rgb(\${colorData.rgb.r}, \${colorData.rgb.g}, \${colorData.rgb.b})
                    \`;
                }
                
                picker.addEventListener('colorchange', (e) => {
                    updateDisplay(e.detail);
                    
                    // If this is the primary color picker, update the accent color
                    if (id === 'primary-color') {
                        updateAccentDisplay(e.detail);
                    }
                });
                
                picker.addEventListener('colorselect', (e) => {
                    console.log(\`\${id} selected:\`, e.detail.hex);
                });
                
                picker.addEventListener('colorcopied', (e) => {
                    console.log(\`Copied \${e.detail.hex} to clipboard\`);
                });
                
                // Initialize display with current color
                const currentColor = picker.color;
                if (currentColor) {
                    updateDisplay(currentColor);
                    
                    // If this is the primary color picker, also initialize accent color
                    if (id === 'primary-color') {
                        updateAccentDisplay(currentColor);
                    }
                }
            });
            
            // Theme selector functionality
            const themeSelector = document.getElementById('theme-selector');
            const primaryPicker = document.getElementById('primary-color');
            
            if (themeSelector && primaryPicker) {
                themeSelector.addEventListener('change', (e) => {
                    const selectedTheme = e.target.value;
                    
                    if (selectedTheme !== 'custom' && themes[selectedTheme]) {
                        const theme = themes[selectedTheme];
                        primaryPicker.setColor(theme.hue, theme.saturation, theme.lightness);
                        
                        // Update the selector to show this is no longer custom
                        e.target.value = selectedTheme;
                    }
                });
                
                // Listen for manual changes to set selector back to custom
                primaryPicker.addEventListener('colorchange', () => {
                    // Set timeout to avoid conflicts with theme selector changes
                    setTimeout(() => {
                        themeSelector.value = 'custom';
                    }, 100);
                });
            }
            
        }, 500); // Increased timeout to ensure color-bar components are ready
        
        // Theme toggle functionality
        function toggleTheme() {
            const body = document.body;
            const isDark = body.classList.contains('dark');
            
            if (isDark) {
                body.classList.remove('dark');
                // Update all wb-color-bars to light theme
                document.querySelectorAll('wb-color-bars').forEach(picker => {
                    picker.setAttribute('theme', 'light');
                });
            } else {
                body.classList.add('dark');
                // Update all wb-color-bars to dark theme
                document.querySelectorAll('wb-color-bars').forEach(picker => {
                    picker.setAttribute('theme', 'dark');
                });
            }
        }
        
        // Demo console logging
        console.log('ðŸŽ¨ Color Bars Demo loaded');
        console.log('Try changing colors and check the console for events!');
        
        // Debug: Check if wb-color-bars components are properly defined
        setTimeout(() => {
            const colorBarsElements = document.querySelectorAll('wb-color-bars');
            console.log(`Found ${colorBarsElements.length} wb-color-bars elements`);
            
            colorBarsElements.forEach((element, index) => {
                console.log(`wb-color-bars ${index + 1}:`, {
                    tagName: element.tagName,
                    attributes: Array.from(element.attributes).map(attr => `${attr.name}="${attr.value}"`),
                    hasColorProperty: 'color' in element,
                    hasSetColorMethod: 'setColor' in element,
                    shadowRoot: element.shadowRoot ? 'exists' : 'missing'
                });
            });
            
            // Check if the individual wb-color-bar components are defined
            console.log('Web component definitions:');
            console.log('wb-color-bars defined:', customElements.get('wb-color-bars') ? 'YES' : 'NO');
            console.log('wb-color-bar defined:', customElements.get('wb-color-bar') ? 'YES' : 'NO');
        }, 2000);
        
        // Initialize theme and components after everything loads
        function initializeDemo() {
            console.log('Initializing demo...');
            
            // Set dark theme
            document.body.classList.add('dark');
            document.documentElement.setAttribute('data-theme', 'dark');
            
            // Update theme toggle button
            const themeButton = document.querySelector('.theme-toggle');
            if (themeButton) {
                themeButton.textContent = 'â˜€ï¸ Light Mode';
            }
            
            // Initialize all wb-color-bars components
            const colorBars = document.querySelectorAll('wb-color-bars');
            console.log(`Found ${colorBars.length} wb-color-bars components`);
            
            colorBars.forEach((picker, index) => {
                console.log(`Initializing wb-color-bars ${index + 1}...`);
                picker.setAttribute('theme', 'dark');
                
                // Force re-render if component has this method
                if (typeof picker.render === 'function') {
                    picker.render();
                }
            });
            
            console.log('Demo initialization complete');
        }
        
        // Initialize when DOM and components are ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', () => {
                setTimeout(initializeDemo, 1000);
            });
        } else {
            setTimeout(initializeDemo, 1000);
        }
        
    </script>
</body>
</html>