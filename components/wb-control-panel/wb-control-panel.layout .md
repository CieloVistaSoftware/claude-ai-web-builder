# File: components/wb-control-panel/wb-control-panel.layout.md
# WB Control Panel Layout 

## Component Layout Structure

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ¨ Control Panel        [ğŸŒ™ DARK]              â”‚  â† Header
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                 â”‚
â”‚ â”Œâ”€ Theme System â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Theme Category: [Named Themes â–¼]           â”‚ â”‚
â”‚ â”‚ Select Theme: [Default â–¼]                  â”‚ â”‚
â”‚ â”‚ Harmony Mode: [Complementary â–¼]            â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€-â”˜ â”‚
â”‚                                                 â”‚
â”‚ â”Œâ”€ Primary Color (HSL) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€-â” â”‚
â”‚ â”‚ Hue:        [====â—========] 240Â°          â”‚ â”‚
â”‚ â”‚ Saturation: [============â—] 70%           â”‚ â”‚
â”‚ â”‚ Lightness:  [======â—======] 50%           â”‚ â”‚
â”‚ â”‚ Preview: [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ]                    â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€-â”˜ â”‚
â”‚                                                 â”‚
â”‚ â”Œâ”€ Background Color (HSL) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Hue:        [===â—=========] 220Â°          â”‚ â”‚
â”‚ â”‚ Saturation: [==â—==========] 20%           â”‚ â”‚
â”‚ â”‚ Lightness:  [â—============] 15%           â”‚ â”‚
â”‚ â”‚ Preview: [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ]                    â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€-â”˜ â”‚
â”‚                                                 â”‚
â”‚ â”Œâ”€ Layout & Footer â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Page Layout: [Top Navigation â–¼]           â”‚ â”‚
â”‚ â”‚ Footer Position: [Sticky â–¼]               â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€-â”˜ â”‚
â”‚                                                 â”‚
â”‚ â”Œâ”€ Edit Mode â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Enable Image Editing [âœ“]                  â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€-â”˜ â”‚
â”‚                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Component Hierarchy

```
wb-control-panel (Web Component)
â”œâ”€â”€ Shadow DOM
â”‚   â”œâ”€â”€ wb-control-panel-shadow.css (External CSS)
â”‚   â””â”€â”€ HTML Template
â”‚       â”œâ”€â”€ .panel-header
â”‚       â”‚   â”œâ”€â”€ .header-content
â”‚       â”‚   â”‚   â”œâ”€â”€ h3 (Title: "ğŸ¨ Control Panel")
â”‚       â”‚   â”‚   â””â”€â”€ p.subtitle (Description)
â”‚       â”‚   â””â”€â”€ .mode-toggle
â”‚       â”‚       â”œâ”€â”€ .mode-icon (ğŸŒ™/â˜€ï¸)
â”‚       â”‚       â””â”€â”€ .mode-label (DARK/LIGHT)
â”‚       â””â”€â”€ .panel-body
â”‚           â”œâ”€â”€ Theme System (.control-group)
â”‚           â”‚   â”œâ”€â”€ #theme-category-dropdown
â”‚           â”‚   â”œâ”€â”€ #theme-dropdown
â”‚           â”‚   â””â”€â”€ #harmony-select
â”‚           â”œâ”€â”€ Primary Color (.control-group)
â”‚           â”‚   â”œâ”€â”€ #hue-slider + #hue-display
â”‚           â”‚   â”œâ”€â”€ #sat-slider + #sat-display
â”‚           â”‚   â”œâ”€â”€ #light-slider + #light-display
â”‚           â”‚   â”œâ”€â”€ .hue-swatch (color preview dot)
â”‚           â”‚   â””â”€â”€ #color-preview (large preview)
â”‚           â”œâ”€â”€ Background Color (.control-group) âš ï¸ NEW
â”‚           â”‚   â”œâ”€â”€ #bg-hue-slider + #bg-hue-display
â”‚           â”‚   â”œâ”€â”€ #bg-sat-slider + #bg-sat-display
â”‚           â”‚   â”œâ”€â”€ #bg-light-slider + #bg-light-display
â”‚           â”‚   â”œâ”€â”€ .bg-hue-swatch (color preview dot)
â”‚           â”‚   â””â”€â”€ #bg-color-preview (large preview)
â”‚           â”œâ”€â”€ Layout & Footer (.control-group)
â”‚           â”‚   â”œâ”€â”€ #layout-select
â”‚           â”‚   â””â”€â”€ #footer-position-select
â”‚           â””â”€â”€ Edit Mode (.control-group)
â”‚               â””â”€â”€ #edit-mode-toggle (checkbox)
```

## State Management

### State Object
```javascript
this.state = {
    // Mode
    mode: 'dark',              // 'dark' | 'light'
    
    // Theme System
    theme: 'default',          // Theme ID
    themeCategory: 'named',    // 'named' | 'hcs'
    harmonyMode: 'complementary', // Harmony algorithm
    
    // Primary Color (HSL)
    primaryHue: 240,           // 0-360
    primarySat: 70,            // 0-100
    primaryLight: 50,          // 0-100
    
    // Background Color (HSL) âš ï¸ NEW
    backgroundHue: 220,        // 0-360
    backgroundSat: 20,         // 0-100
    backgroundLight: 15,       // 0-100
    
    // Layout
    layout: 'top-nav',         // 'top-nav' | 'left-nav' | 'right-nav' | 'ad-layout'
    footerPosition: 'sticky',  // 'sticky' | 'normal'
    
    // Edit Mode
    editMode: false            // boolean
}
```

### LocalStorage Keys
```
wb-mode
wb-theme
wb-theme-category
wb-harmony-mode
wb-hue-primary
wb-sat-primary
wb-light-primary
wb-hue-background       âš ï¸ NEW
wb-sat-background       âš ï¸ NEW
wb-light-background     âš ï¸ NEW
wb-layout
wb-footer-position
wb-edit-mode
```

## Events Dispatched

### Standard Events (wb: prefix)
```javascript
// Mode changes
'wb:mode-changed' 
{ mode: 'dark' | 'light' }

// Theme changes  
'wb:theme-changed'
{ theme: string, category: string, data: object }

// Harmony mode changes
'wb:harmony-changed'
{ mode: string }

// Primary color changes
'wb:color-changed'
{ hue: number, saturation: number, lightness: number, harmonyMode: string }

// Background color changes âš ï¸ NEW
'wb:background-color-changed'
{ hue: number, saturation: number, lightness: number }

// Layout changes
'wb:layout-changed'
{ layout: string }

// Footer position changes
'wb:footer-position-changed'
{ position: string }
```

### Edit Mode Events (no prefix)
```javascript
'editModeEnabled'  // When edit mode turns on
'editModeDisabled' // When edit mode turns off
```

## CSS Custom Properties Updated

The component updates these CSS variables on `:root`:

```css
/* Primary Color */
--primary
--primary-dark
--primary-light
--primary-rgb

/* Background Color âš ï¸ NEW */
--bg-primary
--bg-secondary
--bg-tertiary

/* Mode */
--text-primary
--text-secondary
--border-color
```

## File Structure

```
components/wb-control-panel/
â”œâ”€â”€ wb-control-panel.js             # Main component (class definition first!)
â”œâ”€â”€ wb-control-panel-shadow.css     # Shadow DOM styles (auto-loaded)
â”œâ”€â”€ wb-control-panel.md             # This specification
â”œâ”€â”€ wb-control-panel.schema.json    # JSON schema
â”œâ”€â”€ wb-control-panel-demo.html      # Demo page
â”œâ”€â”€ wb-control-panel-demo.js        # Demo page logic
â”œâ”€â”€ wb-control-panel-demo.css       # Demo page styles
â””â”€â”€ âœ… claude.md                     # Development notes
```

## Key Implementation Requirements

### 1. Shadow DOM
- Component uses Shadow DOM for style encapsulation
- WBBaseComponent already attaches shadow root - DO NOT attach again
- External CSS loaded via `<link>` in shadow root

### 2. Class Structure (CRITICAL!)
```javascript
// Class definition MUST be first line of code after imports
import { WBBaseComponent } from '../wb-base/wb-base.js';

class WBControlPanel extends WBBaseComponent {
    constructor() {
        super(); // WBBaseComponent attaches shadow root
        // Do NOT call this.attachShadow() here!
        
        this.state = { /* ... */ };
    }
    // ... rest of class
}
```

### 3. Two Complete HSL Slider Sets
- **Primary Color**: For main UI elements (buttons, links, accents)
- **Background Color**: For page backgrounds and surfaces
- Each set has 3 sliders: Hue (0-360Â°), Saturation (0-100%), Lightness (0-100%)
- Each set has a color preview swatch
- Real-time updates to CSS custom properties

### 4. Event-Driven Architecture
- Component dispatches events, never manipulates DOM outside shadow root
- Other components listen for events and react accordingly
- No direct component-to-component coupling

### 5. LocalStorage Persistence
- All state saved to localStorage on change
- State restored on component load
- Keys prefixed with `wb-`

## Missing Features to Implement

âœ… **Completed:**
- Shadow DOM with external CSS
- Mode toggle (dark/light)
- Theme selection (Named + HCS)
- Primary color HSL sliders
- Layout control
- Footer positioning
- Edit mode toggle
- Event dispatching
- LocalStorage persistence

âš ï¸ **TO ADD:**
- Background color HSL sliders (3 sliders + preview)
- Update localStorage to save background colors
- Dispatch `wb:background-color-changed` event
- Update CSS custom properties for background colors
- Add background color section to render() method
- Add event listeners for background sliders
- Update loadState() and saveState() methods

## Visual Design Requirements

### Colors
- Dark mode: Semi-transparent dark background with blur
- Light mode: Semi-transparent light background
- Accent: Purple/blue gradient (#6366f1 to #8b5cf6)

### Positioning
- Fixed position: top-right corner
- 1rem margin from edges
- Width: 380px
- Max height: calc(100vh - 2rem)
- Z-index: 10000

### Interactions
- Smooth transitions (0.3s)
- Hover states on all interactive elements
- Focus indicators on sliders
- Mode toggle has scale effect on hover

### Typography
- System font stack
- Headers: 1.5rem, gradient text
- Labels: 0.75rem, uppercase, letter-spacing
- Values: 0.75rem, bold, accent color

## Integration Example

```html
<!DOCTYPE html>
<html lang="en" data-mode="dark">
<head>
    <title>My Site</title>
    <!-- Component auto-loads its CSS -->
</head>
<body>
    <!-- Your content -->
    
    <!-- Control Panel - Self-contained -->
    <wb-control-panel></wb-control-panel>
    
    <script type="module" src="./components/wb-control-panel/wb-control-panel.js"></script>
    
    <script>
        // Listen for color changes
        document.addEventListener('wb:color-changed', (e) => {
            console.log('Primary color:', e.detail);
        });
        
        // Listen for background color changes
        document.addEventListener('wb:background-color-changed', (e) => {
            console.log('Background color:', e.detail);
        });
    </script>
</body>
</html>
```

## Testing Checklist

- [ ] Component loads without errors
- [ ] Shadow DOM created correctly
- [ ] External CSS loads
- [ ] Dark/light mode toggle works
- [ ] Theme dropdown populates
- [ ] Primary color sliders update preview
- [ ] Background color sliders update preview âš ï¸ NEW
- [ ] Layout dropdown changes layout
- [ ] Footer position toggle works
- [ ] Edit mode toggle fires events
- [ ] All state persists to localStorage
- [ ] All events dispatch correctly
- [ ] CSS custom properties update
- [ ] Component works in wb.html showcase
- [ ] No console errors

---

**Last Updated**: 2025-10-19
**Version**: 2.0 (Added background color controls)
