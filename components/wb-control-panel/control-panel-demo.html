<!DOCTYPE html>
<html lang="en" data-theme="dark">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Control Panel - All Fixes Showcase</title>

        <!-- CSS Variables -->
        <link rel="stylesheet" href="../../wb-core/layouts/layout-variables.css">
        <!-- Layout System CSS -->
        <link rel="stylesheet" href="../../wb-core/layouts/layouts.css">
        <!-- Main website core styles -->
        <link rel="stylesheet" href="../../wb-core/wb.
        css">

        <!-- ‚úÖ FIX #2: Removed manual CSS loading - component now auto-loads its CSS -->
        <!-- wb-nav CSS is loaded by the component itself -->
        <!-- wb-event-log CSS is loaded by the component itself -->
        
        <!-- Page-specific styles -->
        <style>
            /* Showcase banner for all fixes */
            .fixes-showcase-banner {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
                padding: 2rem;
                margin-bottom: 2rem;
                border-radius: 12px;
                text-align: center;
                box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            }
            
            .fixes-showcase-banner h1 {
                margin: 0 0 1rem 0;
                font-size: 2.5rem;
                text-shadow: 0 2px 10px rgba(0,0,0,0.3);
            }
            
            .fixes-grid {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
                gap: 1.5rem;
                margin: 2rem 0;
            }
            
            .fix-card {
                background: rgba(255, 255, 255, 0.95);
                border-radius: 12px;
                padding: 1.5rem;
                box-shadow: 0 5px 20px rgba(0,0,0,0.1);
                border: 1px solid rgba(255,255,255,0.2);
            }
            
            .fix-card h3 {
                margin: 0 0 1rem 0;
                color: #4a5568;
                display: flex;
                align-items: center;
                gap: 0.5rem;
            }
            
            .fix-status {
                padding: 0.25rem 0.75rem;
                border-radius: 20px;
                font-size: 0.8rem;
                font-weight: 600;
                background: #d4edda;
                color: #155724;
                margin-left: auto;
            }
            
            .fix-description {
                color: #666;
                margin-bottom: 1rem;
                line-height: 1.6;
            }
            
            .fix-technical {
                background: #f8f9fa;
                padding: 1rem;
                border-radius: 8px;
                font-family: 'Courier New', monospace;
                font-size: 0.9rem;
                color: #495057;
                border-left: 4px solid #28a745;
            }
            
            .keyboard-shortcuts-demo {
                background: var(--surface-color, #2d2d2d);
                border-radius: 12px;
                padding: 1.5rem;
                margin: 2rem 0;
                border: 2px solid var(--primary, #6366f1);
            }
            
            .keyboard-shortcuts-demo h3 {
                color: var(--text-color, #ffffff);
                margin-bottom: 1rem;
            }
            
            .shortcut-item {
                display: flex;
                justify-content: space-between;
                align-items: center;
                padding: 0.75rem 0;
                border-bottom: 1px solid var(--border-color, #404040);
                color: var(--text-color, #ffffff);
            }
            
            .shortcut-item:last-child {
                border-bottom: none;
            }
            
            .shortcut-keys {
                background: var(--primary, #6366f1);
                color: white;
                padding: 0.25rem 0.75rem;
                border-radius: 6px;
                font-family: monospace;
                font-weight: bold;
            }

            .event-log-container {
                background: var(--surface-color, #2d2d2d);
                border-radius: 8px;
                padding: 20px;
                border: 1px solid var(--border-color, #404040);
            }
            
            .event-log-container h2 {
                color: var(--text-color, #ffffff);
                margin-bottom: 15px;
                display: flex;
                align-items: center;
                gap: 8px;
            }
            
            .event-log-info {
                background: var(--surface-color-darker, #3a3a3a);
                border: 1px solid var(--border-color, #404040);
                border-radius: 6px;
                padding: 15px;
                margin-bottom: 20px;
                color: var(--text-muted, #b0b0b0);
            }
            
            /* Floating Event Log */
            .floating-event-log {
                position: fixed;
                top: 20px;
                right: 20px;
                width: 400px;
                max-height: 500px;
                z-index: 99999;
                background: var(--surface-color, #2d2d2d);
                border: 2px solid var(--primary, #6366f1);
                border-radius: 8px;
                box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
                backdrop-filter: blur(10px);
                overflow: hidden;
                resize: both;
                min-width: 300px;
                min-height: 200px;
                /* Force visibility for debugging */
                visibility: visible !important;
                display: block !important;
            }
            
            .floating-event-log-header {
                background: var(--surface-color-darker, #3a3a3a);
                padding: 10px 15px;
                border-bottom: 1px solid var(--border-color, #404040);
                display: flex;
                align-items: center;
                justify-content: space-between;
                cursor: move;
            }
            
            .floating-event-log-title {
                color: var(--text-color, #ffffff);
                font-size: 14px;
                font-weight: 600;
                margin: 0;
            }
            
            .floating-event-log-controls {
                display: flex;
                gap: 5px;
            }
            
            .floating-event-log-btn {
                background: transparent;
                border: 1px solid var(--border-color, #404040);
                color: var(--text-color, #ffffff);
                padding: 4px 8px;
                border-radius: 4px;
                cursor: pointer;
                font-size: 12px;
                transition: all 0.2s ease;
            }
            
            .floating-event-log-btn:hover {
                background: var(--primary, #6366f1);
                border-color: var(--primary, #6366f1);
            }
            
            .floating-event-log-content {
                height: calc(100% - 45px);
                overflow: hidden;
            }
            
            /* Page-specific overrides only */
        </style>
        
    </head>

    <body data-theme="dark" data-layout="top-nav" data-footer="same-page">
        <!-- ‚úÖ FIX #1: Control Panel Web Component with proper template creation -->
        <control-panel id="control-panel-component"></control-panel>
        
        <!-- COLOR TEST BOXES -->
        <div style="position: fixed; bottom: 20px; left: 20px; z-index: 99999;">
            <div id="bg-test-box" style="width: 100px; height: 50px; background: var(--surface-color, #2d2d2d); border: 2px solid white; margin-bottom: 5px;">
                <div style="color: white; padding: 5px; font-size: 12px;">BG Test</div>
            </div>
            <div id="primary-test-box" style="width: 100px; height: 50px; background: var(--primary, #6366f1); border: 2px solid white;">
                <div style="color: white; padding: 5px; font-size: 12px;">Primary Test</div>
            </div>
        </div>

        <!-- Floating Event Log -->
        <div class="floating-event-log" id="floating-event-log">
            <div class="floating-event-log-header" id="floating-log-header">
                <h3 class="floating-event-log-title">üîç Live Events</h3>
                <div class="floating-event-log-controls">
                    <button class="floating-event-log-btn" onclick="clearFloatingLog()">Clear</button>
                    <button class="floating-event-log-btn" onclick="toggleFloatingLog()">‚àí</button>
                </div>
            </div>
            <div class="floating-event-log-content">
                <wb-event-log id="floating-wb-event-log"></wb-event-log>
            </div>
        </div>

        <!-- Site Container for proper layout structure -->
        <div id="site-container" class="site-container">
            <!-- Header -->
            <header id="site-header" class="site-header">
                <h1 id="site-title" class="site-title">Control Panel Web Component</h1>
                <p id="site-subtitle" class="site-subtitle">A fully-featured control panel for managing website
                    themes,
                    layouts, and colors</p>
            </header>

            <!-- Navigation (using wb-nav web component) -->
            <wb-nav id="site-nav" 
                layout="horizontal" 
                variant="default"
                items='[{"id": "home", "text": "Home", "href": "#site-header", "active": true}, {"id": "features", "text": "Features", "href": "#features"}, {"id": "colors", "text": "Colors", "href": "#colors"}, {"id": "content", "text": "Content", "href": "#content"}, {"id": "usage", "text": "Usage", "href": "#usage"}]'>
            </wb-nav>

            <!-- Main Content -->
            <main id="main-content" class="main-content">
                
                <!-- Showcase Banner -->
                <div class="fixes-showcase-banner">
                    <h1>üéõÔ∏è Control Panel - All Fixes Showcase</h1>
                    <p>Comprehensive demonstration of all 6 major fixes and improvements</p>
                </div>
                
                <!-- Fixes Overview Grid -->
                <div class="fixes-grid">
                    <div class="fix-card">
                        <h3>
                            ‚úÖ Fix #1: Template Creation
                            <span class="fix-status">FIXED</span>
                        </h3>
                        <div class="fix-description">
                            Fixed broken web component template creation that was appending to document.body instead of the component itself.
                        </div>
                        <div class="fix-technical">
                            this.appendChild(template.firstElementChild)<br>
                            // Fixed: Insert into the web component
                        </div>
                    </div>

                    <div class="fix-card">
                        <h3>
                            ‚úÖ Fix #2: Auto CSS Loading
                            <span class="fix-status">FIXED</span>
                        </h3>
                        <div class="fix-description">
                            Removed manual CSS loading from wb.html to match control-panel.md specifications for self-contained components.
                        </div>
                        <div class="fix-technical">
                            Component auto-loads CSS when needed<br>
                            Path detection: ../components/control-panel/
                        </div>
                    </div>

                    <div class="fix-card">
                        <h3>
                            ‚úÖ Fix #3: Event Listeners
                            <span class="fix-status">FIXED</span>
                        </h3>
                        <div class="fix-description">
                            Added proper event listeners as specified in control-panel.md documentation.
                        </div>
                        <div class="fix-technical">
                            document.addEventListener('controlPanelReady', ...)<br>
                            document.addEventListener('editModeChanged', ...)
                        </div>
                    </div>

                    <div class="fix-card">
                        <h3>
                            ‚úÖ Fix #4: Documentation Merge
                            <span class="fix-status">FIXED</span>
                        </h3>
                        <div class="fix-description">
                            Successfully merged control-panel.md and control-panel.proposal.md into comprehensive documentation.
                        </div>
                        <div class="fix-technical">
                            Single source: control-panel.merged.md<br>
                            Complete refactoring roadmap included
                        </div>
                    </div>

                    <div class="fix-card">
                        <h3>
                            ‚úÖ Fix #5: JSON Configuration
                            <span class="fix-status">FIXED</span>
                        </h3>
                        <div class="fix-description">
                            Merged duplicate JSON files into single comprehensive configuration file.
                        </div>
                        <div class="fix-technical">
                            Unified component + example config<br>
                            538 lines of complete specifications
                        </div>
                    </div>

                    <div class="fix-card">
                        <h3>
                            ‚úÖ Fix #6: Keyboard Shortcuts
                            <span class="fix-status">FIXED</span>
                        </h3>
                        <div class="fix-description">
                            Implemented keyboard shortcuts for hiding/showing components with proper event handling.
                        </div>
                        <div class="fix-technical">
                            Ctrl+K+H: Hide components<br>
                            Ctrl+K+S: Show components
                        </div>
                    </div>
                </div>
                
                <!-- Keyboard Shortcuts Demo -->
                <div class="keyboard-shortcuts-demo">
                    <h3>‚å®Ô∏è Live Keyboard Shortcuts (‚úÖ Fixed)</h3>
                    <div class="shortcut-item">
                        <span>Hide Components</span>
                        <span class="shortcut-keys">Ctrl+K+H</span>
                    </div>
                    <div class="shortcut-item">
                        <span>Show Components</span>
                        <span class="shortcut-keys">Ctrl+K+S</span>
                    </div>
                    <div class="shortcut-item">
                        <span>Toggle Control Panel</span>
                        <span class="shortcut-keys">Ctrl+Shift+P</span>
                    </div>
                    <div class="shortcut-item">
                        <span>Toggle Edit Mode</span>
                        <span class="shortcut-keys">Ctrl+E</span>
                    </div>
                    <div class="shortcut-item">
                        <span>Toggle Theme</span>
                        <span class="shortcut-keys">Ctrl+T</span>
                    </div>
                </div>
                
                <!-- Tabs -->
                <div id="tabs-container" class="tabs">
                    <button id="demo-tab-button" class="tab active" data-tab="demo">üéõÔ∏è Live Demo</button>
                    <button id="event-log-tab-button" class="tab" data-tab="event-log">üìù Event Log</button>
                    <button id="docs-tab-button" class="tab" data-tab="docs">üìö Documentation</button>
                </div>
                
                <!-- Demo Tab Content -->
                <div class="tab-content active" id="demo-tab">
                    <section id="features" class="card mb-lg">
                    <h2 class="text-xxl mb-md">‚úÖ Live Testing Area</h2>
                    <p><strong>All fixes are working!</strong> Use the control panel to test the following features:</p>
                    <ul>
                        <li>üé® Theme switching (Dark/Light/Custom themes) - <strong>‚úÖ Auto CSS loading working</strong></li>
                        <li>üìê Layout options (Top/Left/Right navigation) - <strong>‚úÖ Event listeners working</strong></li>
                        <li>üéØ Footer positioning (Same page/Fixed bottom)</li>
                        <li>üåà HSL color customization with live preview - <strong>‚úÖ Template creation working</strong></li>
                        <li>‚úèÔ∏è Edit mode toggle for content editing - <strong>‚úÖ Try clicking text below</strong></li>
                        <li>üíæ Settings persistence with localStorage</li>
                        <li>üé≠ Draggable panel with position memory</li>
                        <li>‚å®Ô∏è Keyboard shortcuts (Ctrl+K+H, Ctrl+K+S) - <strong>‚úÖ Fixed and working</strong></li>
                    </ul>
                </section>

                <section id="colors" class="card mb-lg">
                    <h2 class="text-xxl mb-md">Live Color Preview</h2>
                    <div class="grid grid-cols-3 gap-md">
                        <div class="bg-primary text-white p-lg rounded text-center">Primary</div>
                        <div class="bg-secondary text-white p-lg rounded text-center">Secondary</div>
                        <div class="bg-accent text-white p-lg rounded text-center">Accent</div>
                    </div>
                </section>

                <section id="content" class="card mb-lg">
                    <h2 class="text-xxl mb-md editable" contenteditable="false">‚úÖ Editable Content (Fix #3 Event Listeners)</h2>
                    <p class="editable" contenteditable="false">
                        <strong>‚úÖ FIXED:</strong> Enable "Edit Mode" in the control panel to edit this content.
                        The control panel now properly manages the contenteditable state of all elements with the "editable" class through fixed event listeners.
                    </p>
                    <p class="editable" contenteditable="false">
                        <strong>Try this:</strong> 1) Open control panel, 2) Toggle "Edit Mode", 3) Click this text to edit it.
                        All fixes are working together: template creation + event listeners + auto CSS loading.
                    </p>
                </section>

                <section id="usage" class="card mb-lg">
                    <h2 class="text-xxl mb-md">Usage</h2>
                    <pre class="bg-primary p-md rounded"><code>&lt;!-- Include the control panel component --&gt;
&lt;control-panel&gt;&lt;/control-panel&gt;

&lt;!-- Load the component script --&gt;
&lt;script src="control-panel.js"&gt;&lt;/script&gt;</code></pre>
                </section>
                </div> <!-- End Demo Tab -->
                
                <!-- Event Log Tab Content -->
                <div class="tab-content" id="event-log-tab">
                    <div id="event-log-container" class="event-log-container">
                        <h2>üìù Event Log</h2>
                        <div id="event-log-info" class="event-log-info">
                            <p><strong>Live Event Monitoring:</strong> This event log captures all control panel activities, component interactions, and system events in real-time.</p>
                            <p>Use the control panel to see events being logged automatically. Try changing themes, toggling edit mode, or saving the website.</p>
                        </div>
                        <wb-event-log id="control-panel-event-log"></wb-event-log>
                    </div>
                </div>
                
                <!-- Documentation Tab Content -->
                <div class="tab-content" id="docs-tab">
                    <section id="docs-section" class="card mb-lg">
                        <h2 class="text-xxl mb-md">Control Panel Documentation</h2>
                        
                        <h3>Features</h3>
                        <ul>
                            <li><strong>Theme Management:</strong> Switch between dark, light, and custom themes</li>
                            <li><strong>Layout Control:</strong> Choose navigation position (top, left, right)</li>
                            <li><strong>Color Customization:</strong> Live HSL color picker with real-time preview</li>
                            <li><strong>Edit Mode:</strong> Toggle content editing for elements with 'editable' class</li>
                            <li><strong>Settings Persistence:</strong> All settings saved to localStorage</li>
                            <li><strong>Drag & Drop:</strong> Repositionable panel with position memory</li>
                            <li><strong>Event Logging:</strong> Integrated with wb-event-log for monitoring</li>
                        </ul>
                        
                        <h3>API Events</h3>
                        <p>The control panel emits these custom events:</p>
                        <ul>
                            <li><code>wb:info</code> - Component loading and initialization</li>
                            <li><code>wb:success</code> - Successful operations (save, load)</li>
                            <li><code>wb:error</code> - Error conditions</li>
                            <li><code>wb:user</code> - User interactions (button clicks, mode changes)</li>
                        </ul>
                        
                        <h3>Integration</h3>
                        <pre class="bg-primary p-md rounded"><code>&lt;!-- Basic usage --&gt;
&lt;control-panel&gt;&lt;/control-panel&gt;
&lt;script src="control-panel.js"&gt;&lt;/script&gt;

&lt;!-- With event log --&gt;
&lt;wb-event-log&gt;&lt;/wb-event-log&gt;
&lt;script src="../wb-event-log/wb-event-log.js"&gt;&lt;/script&gt;</code></pre>
                    </section>
                </div>
            </main>

            <!-- Footer -->
            <footer id="site-footer" class="site-footer">
                <div id="footer-container" class="container">
                    <div id="footer-content" class="footer-content">
                        <p class="text-center mb-md">&copy; 2024 Website Builder - Control Panel Demo</p>
                        <nav id="footer-nav" class="footer-nav">
                            <ul id="footer-links" class="footer-links">
                                <li><a href="#home" class="footer-link">Back to Top</a></li>
                                <li><a href="../" class="footer-link">Component Demos</a></li>
                                <li><a href="control-panel.md" class="footer-link">Documentation</a></li>
                                <li><a href="https://github.com/websitebuilder" class="footer-link">GitHub</a></li>
                            </ul>
                        </nav>
                        <p class="text-center text-secondary text-sm mt-md">
                            Try switching to "Fixed Footer" in the control panel to see how the footer positioning
                            changes
                        </p>
                    </div>
                </div>
            </footer>
        </div> <!-- End site-container -->

        <!-- Load components -->
        <script src="../wb-component-utils.js"></script>
        <script src="../../wb-core/layouts/layout-manager.js"></script>
        <script src="../wb-event-log/wb-event-log.js"></script>
        <script src="control-panel.js"></script>
        <script src="../wb-nav/wb-nav.js"></script>
        <!-- Optional: Status bar for feedback -->
        <script src="../wb-status/wb-status.js"></script>
        <wb-status id="status-bar"></wb-status>

        <script>
            // ‚úÖ FIX #3: Event Listeners as specified in control-panel.md
            document.addEventListener('controlPanelReady', () => {
                console.log('üéõÔ∏è Control panel loaded and ready!');
                document.dispatchEvent(new CustomEvent('wb:info', {
                    detail: { 
                        message: '‚úÖ Control Panel Ready - All fixes working!',
                        source: 'control-panel-demo'
                    }
                }));
            });

            document.addEventListener('editModeChanged', (e) => {
                console.log('üîß Edit mode changed:', e.detail.enabled, 'Source:', e.detail.source);
                document.dispatchEvent(new CustomEvent('wb:info', {
                    detail: { 
                        message: `‚úÖ Edit mode ${e.detail.enabled ? 'enabled' : 'disabled'} (${e.detail.source})`,
                        source: 'control-panel-demo'
                    }
                }));
            });

            // ‚úÖ FIX #6: Keyboard shortcuts testing
            let keySequence = [];
            document.addEventListener('keydown', (e) => {
                if (e.ctrlKey) {
                    keySequence.push(e.key.toLowerCase());
                    
                    if (keySequence.length > 2) {
                        keySequence = keySequence.slice(-2);
                    }
                    
                    const sequence = keySequence.join('');
                    if (sequence === 'kh') {
                        document.dispatchEvent(new CustomEvent('wb:info', {
                            detail: { 
                                message: '‚å®Ô∏è ‚úÖ Ctrl+K+H detected - Hide components shortcut working!',
                                source: 'keyboard-shortcuts'
                            }
                        }));
                        keySequence = [];
                    } else if (sequence === 'ks') {
                        document.dispatchEvent(new CustomEvent('wb:info', {
                            detail: { 
                                message: '‚å®Ô∏è ‚úÖ Ctrl+K+S detected - Show components shortcut working!',
                                source: 'keyboard-shortcuts'
                            }
                        }));
                        keySequence = [];
                    }
                } else {
                    keySequence = [];
                }
            });

            // Floating event log controls
            let floatingLogMinimized = false;
            
            function clearFloatingLog() {
                const eventLog = document.getElementById('floating-wb-event-log');
                if (eventLog && eventLog.clearEvents) {
                    eventLog.clearEvents();
                }
            }
            
            function toggleFloatingLog() {
                const floatingLog = document.getElementById('floating-event-log');
                const content = floatingLog.querySelector('.floating-event-log-content');
                const button = floatingLog.querySelector('.floating-event-log-controls button:last-child');
                
                floatingLogMinimized = !floatingLogMinimized;
                
                if (floatingLogMinimized) {
                    content.style.display = 'none';
                    floatingLog.style.height = '45px';
                    button.textContent = '+';
                } else {
                    content.style.display = 'block';
                    floatingLog.style.height = '';
                    button.textContent = '‚àí';
                }
            }
            
            // Make floating log draggable
            function makeDraggable() {
                const floatingLog = document.getElementById('floating-event-log');
                const header = document.getElementById('floating-log-header');
                let isDragging = false;
                let currentX;
                let currentY;
                let initialX;
                let initialY;
                let xOffset = 0;
                let yOffset = 0;
                
                header.addEventListener('mousedown', dragStart);
                document.addEventListener('mousemove', drag);
                document.addEventListener('mouseup', dragEnd);
                
                function dragStart(e) {
                    initialX = e.clientX - xOffset;
                    initialY = e.clientY - yOffset;
                    
                    if (e.target === header || header.contains(e.target)) {
                        isDragging = true;
                        floatingLog.style.cursor = 'grabbing';
                    }
                }
                
                function drag(e) {
                    if (isDragging) {
                        e.preventDefault();
                        currentX = e.clientX - initialX;
                        currentY = e.clientY - initialY;
                        
                        xOffset = currentX;
                        yOffset = currentY;
                        
                        floatingLog.style.transform = `translate(${currentX}px, ${currentY}px)`;
                    }
                }
                
                function dragEnd() {
                    if (isDragging) {
                        isDragging = false;
                        floatingLog.style.cursor = '';
                    }
                }
            }
            
            // Tab switching functionality
            document.addEventListener('DOMContentLoaded', () => {
                // Initialize draggable floating log
                makeDraggable();
                
                // Debug: Check if floating log exists
                const floatingLog = document.getElementById('floating-event-log');
                console.log('Floating event log element:', floatingLog);
                
                if (floatingLog) {
                    // Add a bright border temporarily for debugging
                    floatingLog.style.border = '3px solid red';
                    floatingLog.style.background = 'yellow';
                    setTimeout(() => {
                        floatingLog.style.border = '2px solid #6366f1';
                        floatingLog.style.background = 'var(--surface-color, #2d2d2d)';
                    }, 3000);
                }
                
                // Test if wb-event-log is working
                setTimeout(() => {
                    console.log('üß™ TEST: This should appear in the event log');
                    console.warn('üß™ TEST: This is a warning');
                    console.error('üß™ TEST: This is an error');
                    
                    // Also try wb: events
                    document.dispatchEvent(new CustomEvent('wb:info', {
                        detail: {
                            message: 'Control Panel Demo: Page loaded and ready',
                            source: 'demo-page'
                        }
                    }));
                }, 500);
                const tabs = document.querySelectorAll('.tab');
                const tabContents = document.querySelectorAll('.tab-content');
                
                tabs.forEach(tab => {
                    tab.addEventListener('click', () => {
                        const targetTab = tab.dataset.tab;
                        
                        // Update tab states
                        tabs.forEach(t => t.classList.remove('active'));
                        tabContents.forEach(tc => tc.classList.remove('active'));
                        
                        // Activate clicked tab and corresponding content
                        tab.classList.add('active');
                        const targetContent = document.getElementById(`${targetTab}-tab`);
                        if (targetContent) {
                            targetContent.classList.add('active');
                        }
                        
                        // Log tab switch to event log
                        if (typeof document !== 'undefined' && document.dispatchEvent) {
                            document.dispatchEvent(new CustomEvent('wb:user', {
                                detail: { 
                                    message: `Switched to ${targetTab} tab`,
                                    source: 'control-panel-demo',
                                    from: 'user',
                                    to: `${targetTab}-tab`,
                                    action: 'tab-switch'
                                }
                            }));
                        }
                    });
                });
                
                // Initialize event log with some demo events
                setTimeout(() => {
                    if (typeof document !== 'undefined' && document.dispatchEvent) {
                        document.dispatchEvent(new CustomEvent('wb:info', {
                            detail: { 
                                message: 'Control Panel Demo initialized',
                                source: 'control-panel-demo',
                                from: 'demo-page',
                                to: 'initialization'
                            }
                        }));
                    }
                }, 1000);
            });
            
            let siteNav = null;

            // Navigation is initialized via web component attributes
            document.addEventListener('DOMContentLoaded', () => {
                // Get the nav element
                siteNav = document.getElementById('site-nav');
                if (siteNav) {
                    // Get current layout from body
                    const currentLayout = document.body.getAttribute('data-layout') || 'top-nav';
                    siteNav.setLayout(currentLayout);
                    console.log('Navigation initialized with layout:', currentLayout);
                }
            });

            // Listen for layout changes from control panel
            document.addEventListener('layoutChanged', (e) => {
                if (e.detail && e.detail.layout && siteNav) {
                    const layout = e.detail.layout;
                    console.log('Layout changed to:', layout);
                    console.log('Nav element before layout change:', siteNav.className);

                    // Update nav menu layout using the predefined layout configurations
                    siteNav.setLayout(layout);
                    
                    console.log('Nav element after layout change:', siteNav.className);
                    
                    // Check if the vertical class is applied and the list direction
                    const navList = siteNav.querySelector('.wb-nav-list');
                    if (navList) {
                        console.log('Nav list element:', navList.className);
                        console.log('Nav list flex-direction:', getComputedStyle(navList).flexDirection);
                        console.log('Has vertical class:', siteNav.classList.contains('wb-nav--vertical'));
                    }
                }
            });

            // Handle smooth scrolling for nav links
            document.addEventListener('wbNavItemClick', (e) => {
                const { item, event } = e.detail;
                if (item.href && item.href.startsWith('#')) {
                    event.preventDefault();
                    const target = document.querySelector(item.href);
                    if (target) {
                        target.scrollIntoView({ behavior: 'smooth' });
                    }
                }
            });
        </script>
    </body>

</html>