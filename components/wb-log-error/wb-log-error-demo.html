<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WB Log Error Component Demo</title>
    
    <!-- Central Styles Import -->
    <!-- Website Builder Main Styles (Variables, Base, Utilities) -->
    <link rel="stylesheet" href="../../styles/main.css">    <!-- Load wb-log-error web component -->
    <script src="wb-log-error-webcomponent.js"></script>
    
    <!-- Demo Styles -->
    <style>
        body {
            margin: 0;
            padding: var(--space-xl);
        }
        
        h1 {
            color: var(--primary);
            margin-bottom: var(--space-sm);
        }
        
        .demo-section {
            background: var(--bg-secondary);
            padding: var(--space-lg);
            margin: var(--space-md) 0;
            border-radius: var(--radius-lg);
            border-left: 4px solid var(--primary);
            border: 1px solid var(--border-color);
        }
        
        .demo-section h2 {
            margin-top: 0;
            color: var(--primary);
        }
        
        .demo-section h3 {
            color: var(--accent);
        }
        
        .demo-buttons {
            display: flex;
            gap: var(--space-md);
            flex-wrap: wrap;
            margin: var(--space-md) 0;
        }
        
        .btn {
            background: var(--btn-primary-bg);
            color: var(--btn-primary-text);
            border: none;
            padding: var(--space-sm) var(--space-md);
            border-radius: var(--radius-md);
            cursor: pointer;
            font-size: var(--text-sm);
            transition: var(--transition-colors);
        }
        
        .btn:hover {
            background: var(--btn-primary-hover);
        }
        
        .btn-secondary {
            background: var(--btn-secondary-bg);
            color: var(--btn-secondary-text);
        }
        
        .btn-secondary:hover {
            background: var(--btn-secondary-hover);
        }
        
        .btn-danger {
            background: var(--error-color);
            color: white;
        }
        
        .btn-danger:hover {
            background: #dc2626;
        }
        
        .btn-warning {
            background: var(--warning-color);
            color: white;
        }
        
        .btn-warning:hover {
            background: #d97706;
        }
        
        .status-box {
            background: rgba(var(--success-color-rgb), 0.1);
            border: 1px solid rgba(var(--success-color-rgb), 0.3);
            padding: var(--space-md);
            border-radius: var(--radius-base);
            margin: var(--space-md) 0;
            color: var(--text-primary);
        }
        
        code {
            background: var(--bg-tertiary);
            padding: var(--space-xs) var(--space-sm);
            border-radius: var(--radius-sm);
            font-family: var(--font-mono);
            font-size: var(--text-sm);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }
        
        .feature-list {
            list-style: none;
            padding: 0;
        }
        
        .feature-list li {
            padding: var(--space-sm) 0;
            border-bottom: 1px solid var(--border-color);
        }
        
        .feature-list li:last-child {
            border-bottom: none;
        }
        
        .shortcut-hint {
            background: var(--bg-tertiary);
            padding: var(--space-md);
            border-radius: var(--radius-base);
            margin: var(--space-md) 0;
            border: 1px solid var(--border-color);
        }
        
        .shortcut-hint kbd {
            background: var(--bg-primary);
            padding: var(--space-xs) var(--space-sm);
            border-radius: var(--radius-sm);
            font-family: var(--font-mono);
            border: 1px solid var(--border-color);
            margin: 0 var(--space-xs);
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: var(--space-md);
            margin: var(--space-md) 0;
        }
        
        .stat-card {
            background: var(--bg-tertiary);
            padding: var(--space-md);
            border-radius: var(--radius-base);
            text-align: center;
            border: 1px solid var(--border-color);
        }
        
        .stat-value {
            font-size: var(--text-2xl);
            font-weight: var(--font-bold);
            color: var(--primary);
        }
        
        .stat-label {
            color: var(--text-secondary);
            font-size: var(--text-sm);
            margin-top: var(--space-xs);
        }
    </style>
</head>
<body data-theme="dark">
    <h1>WB Log Error Component Demo</h1>
    <p>Error logging and notification component for debugging and monitoring.</p>
    
    <div class="demo-section" id="event-log-section" title="Live Error Log Display">
        <h2>üìã Event Log</h2>
        <p>Live display of all errors, warnings, and debug messages. The log will appear here automatically when errors occur.</p>
        <div class="status-box" id="event-log-status" title="Event Log Status">
            <strong>Status:</strong> <span id="log-status">Ready</span><br>
            <strong>Auto-show:</strong> Enabled<br>
            <small style="color: var(--text-secondary);">The error log will automatically appear when the first error is logged</small>
        </div>
        
        <!-- WB Log Error Web Component -->
        <wb-log-error 
            position="bottom-right" 
            visible="true" 
            enable-export="true" 
            enable-clear="true" 
            enable-toggle="true"
            max-entries="100">
        </wb-log-error>
    </div>
    
    <div class="demo-section" id="error-logging-section" title="Error Logging Test Functions">
        <h2>üö® Error Logging</h2>
        <p>Test different types of error logging:</p>
        <div class="demo-buttons" id="error-logging-buttons" title="Error Logging Button Group">
            <button class="btn btn-danger" onclick="testError()">Test Error</button>
            <button class="btn btn-warning" onclick="testWarning()">Test Warning</button>
            <button class="btn" onclick="testInfo()">Test Info</button>
            <button class="btn btn-secondary" onclick="testDebug()">Test Debug</button>
        </div>
    </div>
    
    <div class="demo-section" id="simulated-errors-section" title="Real JavaScript Error Simulation">
        <h2>üí• Simulated Real Errors</h2>
        <p>Trigger actual JavaScript errors that will be automatically captured:</p>
        <div class="demo-buttons" id="simulated-errors-buttons" title="Simulated Error Button Group">
            <button class="btn btn-danger" onclick="triggerRuntimeError()">Runtime Error</button>
            <button class="btn btn-danger" onclick="triggerReferenceError()">Reference Error</button>
            <button class="btn btn-danger" onclick="triggerTypeError()">Type Error</button>
            <button class="btn btn-danger" onclick="triggerPromiseRejection()">Promise Rejection</button>
        </div>
    </div>
    
    <div class="demo-section" id="controls-section" title="Error Log Control Panel">
        <h2>üéõÔ∏è Controls</h2>
        <p>Control the error log display and behavior:</p>
        <div class="demo-buttons" id="controls-buttons" title="Control Button Group">
            <button class="btn" onclick="getLogComponent().show()">Show Log</button>
            <button class="btn" onclick="getLogComponent().hide()">Hide Log</button>
            <button class="btn" onclick="getLogComponent().toggleVisibility()">Toggle Log</button>
            <button class="btn btn-secondary" onclick="getLogComponent().clearErrors()">Clear All</button>
            <button class="btn btn-secondary" onclick="getLogComponent().copyToClipboard()">üìã Copy to Clipboard</button>
            <button class="btn btn-secondary" onclick="getLogComponent().exportErrors('json')">Export JSON</button>
            <button class="btn btn-secondary" onclick="getLogComponent().exportErrors('csv')">Export CSV</button>
            <button class="btn btn-secondary" onclick="getLogComponent().exportErrors('issues')">Export issues.md</button>
            <button class="btn" onclick="getLogComponent().error('Manual error added', 'demo.js')">‚ûï Add Error</button>
        </div>
    </div>
    
    <div class="demo-section" id="statistics-section" title="Error Statistics Dashboard">
        <h2>üìä Statistics</h2>
        <p>Current error log statistics:</p>
        <div class="stats-grid" id="stats-grid" title="Statistics Grid Display">
            <!-- Stats will be populated by JavaScript -->
        </div>
        <button class="btn btn-secondary" onclick="updateStats()">Refresh Stats</button>
    </div>
    
    <div class="demo-section" id="export-file-section" title="Error Log Export Options">
        <h2>üìÑ Export to File</h2>
        <p>Export your error log as a Markdown file for documentation or issue tracking:</p>
        <ul>
            <li><strong>Persistent Storage:</strong> Errors are stored in browser localStorage</li>
            <li><strong>Markdown Export:</strong> Download errors formatted as a clean .md file</li>
            <li><strong>Export Button:</strong> Click "Export issues.md" to download the current log</li>
            <li><strong>Manual Addition:</strong> Use the ‚ûï button to add custom errors</li>
        </ul>
        <div class="status-box" id="export-status-box" title="Export Status Information">
            <strong>Export filename:</strong> <code id="file-path">issues.md</code><br>
            <strong>Errors ready for export:</strong> <span id="file-count">0</span><br>
            <small style="color: var(--text-secondary);">Note: Errors are stored in localStorage, not written to disk</small>
        </div>
    </div>
    
    <div class="demo-section" id="keyboard-shortcuts-section" title="Keyboard Shortcuts Reference">
        <h2>‚å®Ô∏è Keyboard Shortcuts</h2>
        <div class="shortcut-hint" id="shortcut-hint" title="Keyboard Shortcuts Information">
            <strong>Available shortcuts:</strong><br>
            <kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>E</kbd> - Toggle error log<br>
            <kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>C</kbd> - Clear all errors<br>
            <kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>X</kbd> - Export errors
        </div>
    </div>
    
    <div class="demo-section" id="code-examples-section" title="Code Usage Examples">
        <h2>üíª Code Examples</h2>
        <h3>Basic Logging</h3>
        <pre><code>// Get the web component instance
const logComponent = document.querySelector('wb-log-error');

// Log different types of messages
logComponent.error('Something went wrong!');
logComponent.warn('This is a warning');
logComponent.info('Information message');
logComponent.debug('Debug information');

// Log with additional context
logComponent.error('API call failed', 'api.js', error.stack);
</code></pre>
        
        <h3>API Methods</h3>
        <pre><code>// Control visibility
logComponent.show();
logComponent.hide();
logComponent.toggleVisibility();

// Get data
const errors = logComponent.getErrors();
const stats = logComponent.getStats();

// Clear and export
logComponent.clearErrors();
logComponent.exportErrors('json'); // or 'csv', 'issues'
</code></pre>
        
        <h3>Event Handling</h3>
        <pre><code>// Listen for error events
document.addEventListener('wb-log-error:new', (e) => {
    console.log('New error logged:', e.detail);
});

document.addEventListener('wb-log-error:clear', (e) => {
    console.log('Errors cleared');
});

document.addEventListener('wb-log-error:ready', (e) => {
    console.log('Component ready:', e.detail.component);
});
</code></pre>
    </div>
    
    <div class="demo-section" id="features-section" title="Features and Capabilities">
        <h2>‚ú® Features</h2>
        <ul class="feature-list">
            <li>‚úÖ Automatic capture of console errors and warnings</li>
            <li>‚úÖ Automatic capture of unhandled JavaScript errors</li>
            <li>‚úÖ Automatic capture of unhandled Promise rejections</li>
            <li>‚úÖ Multiple log levels with color coding and icons</li>
            <li>‚úÖ Persistent storage across browser sessions</li>
            <li>‚úÖ Export functionality (JSON, CSV, TXT formats)</li>
            <li>‚úÖ Keyboard shortcuts for quick access</li>
            <li>‚úÖ Stack trace viewing for detailed debugging</li>
            <li>‚úÖ Configurable positioning and behavior</li>
            <li>‚úÖ Event-driven architecture for integration</li>
            <li>‚úÖ Responsive design for mobile devices</li>
            <li>‚úÖ Accessibility support with ARIA attributes</li>
            <li>‚úÖ Automatic file logging to issues.md</li>
            <li>‚úÖ Manual error addition via interactive dialog</li>
            <li>‚úÖ Markdown export for external issue tracking</li>
        </ul>
    </div>
    
    <script>
        // Get the web component instance
        function getLogComponent() {
            return document.querySelector('wb-log-error');
        }

        // Demo functions
        function testError() {
            getLogComponent().error('This is a test error message', 'demo.js');
        }
        
        function testWarning() {
            getLogComponent().warn('This is a test warning message', 'demo.js');
        }
        
        function testInfo() {
            getLogComponent().info('This is a test info message', 'demo.js');
        }
        
        function testDebug() {
            getLogComponent().debug('This is a test debug message', 'demo.js');
        }
        
        function triggerRuntimeError() {
            // This will trigger a runtime error
            let undefined_variable;
            undefined_variable.nonexistent_property.access();
        }
        
        function triggerReferenceError() {
            // This will trigger a reference error
            nonExistentFunction();
        }
        
        function triggerTypeError() {
            // This will trigger a type error
            const num = 42;
            num.toUpperCase();
        }
        
        function triggerPromiseRejection() {
            // This will trigger an unhandled promise rejection
            new Promise((resolve, reject) => {
                reject(new Error('Simulated promise rejection'));
            });
        }
        
        function updateStats() {
            const stats = getLogComponent().getStats();
            const fileLogCount = stats.total; // Use total as file log count
            const statsGrid = document.getElementById('stats-grid');
            
            statsGrid.innerHTML = `
                <div class="stat-card">
                    <div class="stat-value">${stats.total}</div>
                    <div class="stat-label">Total</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${stats.errors}</div>
                    <div class="stat-label">Errors</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${stats.warnings}</div>
                    <div class="stat-label">Warnings</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${stats.info}</div>
                    <div class="stat-label">Info</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${stats.debug}</div>
                    <div class="stat-label">Debug</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${fileLogCount}</div>
                    <div class="stat-label">File Log</div>
                </div>
            `;
            
            // Update file info
            const filePath = document.getElementById('file-path');
            const fileCount = document.getElementById('file-count');
            if (filePath) filePath.textContent = 'issues.md';
            if (fileCount) fileCount.textContent = fileLogCount;
        }
        
        // Initialize demo
        document.addEventListener('wb-log-error:ready', () => {
            console.log('WB Log Error component is ready!');
            
            // Clear localStorage once to remove old format entries
            if (!sessionStorage.getItem('wb-log-error-cleared-old-format')) {
                getLogComponent().clearErrors();
                sessionStorage.setItem('wb-log-error-cleared-old-format', 'true');
                console.log('Cleared old format error logs');
            }
            
            updateStats();
            
            // Show the error log initially
            setTimeout(() => {
                getLogComponent().show();
            }, 1000);
        });
        
        // Update stats when errors change
        document.addEventListener('wb-log-error:new', () => {
            updateStats();
        });
        
        document.addEventListener('wb-log-error:clear', () => {
            updateStats();
        });
        
        // Auto-update stats every 5 seconds
        setInterval(updateStats, 5000);
    </script>
</body>
</html>