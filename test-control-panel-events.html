<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Control Panel Event Test</title>
  <script src="../components/wb-control-panel/wb-control-panel.js"></script>
  <style>
    body { font-family: sans-serif; }
    .result { margin: 1em 0; padding: 0.5em; border-radius: 4px; }
    .pass { background: #e0ffe0; color: #1a7f1a; }
    .fail { background: #ffe0e0; color: #a11; }
  </style>
</head>
<body>
  <h1>Control Panel Event Test</h1>
  <div id="results"></div>
  <!-- Static Control Panel Markup -->
  <div id="static-panel">
    <select id="layout-select">
      <option value="top-nav">Top Navigation</option>
      <option value="left-nav">Left Navigation</option>
      <option value="right-nav">Right Navigation</option>
    </select>
    <select id="theme-select">
      <option value="dark">Dark</option>
      <option value="light">Light</option>
    </select>
  </div>
  <!-- Web Component Panel -->
  <wb-control-panel id="web-panel"></wb-control-panel>
  <script>
    // Test 1: Static HTML Control Panel
    let staticLayoutEvent = false;
    let staticThemeEvent = false;
    document.addEventListener('wb:layout-changed', () => { staticLayoutEvent = true; });
    document.addEventListener('wb:theme-changed', () => { staticThemeEvent = true; });
    // Simulate user changing layout
    const layoutSelect = document.getElementById('layout-select');
    if (layoutSelect) {
      layoutSelect.value = 'left-nav';
      layoutSelect.dispatchEvent(new Event('change', { bubbles: true }));
    }
    // Simulate user changing theme
    const themeSelect = document.getElementById('theme-select');
    if (themeSelect) {
      themeSelect.value = 'light';
      themeSelect.dispatchEvent(new Event('change', { bubbles: true }));
    }
    setTimeout(() => {
      const staticResult = staticLayoutEvent && staticThemeEvent;
      const resultsDiv = document.getElementById('results');
      const div = document.createElement('div');
      div.className = 'result ' + (staticResult ? 'pass' : 'fail');
      div.textContent = 'Static Panel: ' + (staticResult ? 'PASS (events fired)' : 'FAIL (no custom events)');
      resultsDiv.appendChild(div);
    }, 500);
    // Test 2: wb-control-panel Web Component
    let webLayoutEvent = false;
    let webThemeEvent = false;
    document.addEventListener('wb:layout-changed', () => { webLayoutEvent = true; });
    document.addEventListener('wb:theme-changed', () => { webThemeEvent = true; });
    setTimeout(() => {
      const panel = document.getElementById('web-panel');
      // Simulate user changing layout
      const layoutSelect = panel.querySelector('#layout-select');
      if (layoutSelect) {
        layoutSelect.value = 'left-nav';
        layoutSelect.dispatchEvent(new CustomEvent('wb-select:change', { detail: { value: 'left-nav' }, bubbles: true }));
      }
      // Simulate user changing theme
      const themeSelect = panel.querySelector('#theme-select');
      if (themeSelect) {
        themeSelect.value = 'light';
        themeSelect.dispatchEvent(new CustomEvent('wb-select:change', { detail: { value: 'light' }, bubbles: true }));
      }
      setTimeout(() => {
        const webResult = webLayoutEvent && webThemeEvent;
        const resultsDiv = document.getElementById('results');
        const div = document.createElement('div');
        div.className = 'result ' + (webResult ? 'pass' : 'fail');
        div.textContent = 'Web Component Panel: ' + (webResult ? 'PASS (events fired)' : 'FAIL (no custom events)');
        resultsDiv.appendChild(div);
      }, 800);
    }, 1000);
  </script>
</body>
</html>
